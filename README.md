# 高考志愿小程序需求方案（v0.9 草案）

## 1. 项目背景与目标

- **痛点**：高考出分后填报时间紧（≈ 1 周），信息碎片化：分数线、专业口碑、地域偏好、志愿策略等分散在不同网站与公众号。
- **目标**：为考生提供“一键生成”的「冲 / 稳 / 保」志愿方案，并对方案中的每个“学校 + 专业”组合给出可视化对比与解释，减少信息检索与决策成本。

## 2. 业务流程概览

```
[输入页] → [偏好确认页] → 调用后端/模型 → [志愿清单页]
                     ↑
         对比分析 / 收藏 / 分享 / 导出
```

## 3. 功能需求

### 3.1 输入模块

| 字段         | 说明                         | 校验               |
| ------------ | ---------------------------- | ------------------ |
| 省份         | 枚举                         | 必填               |
| 选科类       | 物理/历史类                  | 必填               |
| 总分 / 位次  | 二选一                       | 分数 0–750；位次>0 |
| 目标批次     | 本科一批 / 综合评价…         | 默认自动匹配       |
| 偏好权重滑块 | 地理/排名/就业/升学/生活成本 | 0–5 星             |
| 地理偏好     | 多选树（城市）               | ≤10 项             |
| 正面专业清单 | 多选树（学科→专业）          | ≤10 项             |
| 负面专业清单 | 同上                         | ≤10 项             |

### 3.2 推荐算法

1. **过滤**：剔除负面专业（或标红提示）；若正面清单非空只保留其中专业。
2. **评分 S = wᵀ·X**：X 包含近三年最低位次差、QS/软科排名、就业率、升学率、城市吸引力、生活成本。
3. **录取概率 P**：基于历年分段拟合（高斯核平滑）。
4. **分档**：
   - 冲 (P < 0.30)
   - 稳 (0.30 ≤ P ≤ 0.70)
   - 保 (P > 0.70)

### 3.3 志愿清单展示

- **组合卡片**：学校、专业、往年最低位次、P、S、冲稳保标识。
- **Tab 切换**：默认按综合评分降序；支持按录取概率/排名排序。
- **收藏按钮**：星标，支持批量导出。
- **高亮解释**：点击 “i” 弹层显示指标来源与计算方式。

### 3.4 对比分析

- **雷达图**：QS 排名、就业率、升学率、城市 GDP、人均花费。
- **柱状图**：近三年最低位次趋势。
- **文字摘要**：≥120字，突出各自强弱项与匹配度。

### 3.5 辅助功能

- **分享**：生成海报，含二维码、小程序码、TOP 3 志愿简表。
- **导出**：Word/PDF；含详细指标表格。
- **历史记录**：自动保存最近 5 次查询，与用户账号绑定。
- **埋点**：`page_view`、`click_card`、`compare_open`、`export_pdf`、`share_success`

## 4. 非功能需求（可由前后端进一步完善）

| 类别   | 目标                              |
| ------ | --------------------------------- |
| 性能   | 冷启动 ≤ 2.5s；推荐接口 ≤ 5s      |
| 稳定性 | Crash率 < 1%；接口错误率 < 0.5%   |
| 可用性 | 重要路径通过率 > 99%（6月高峰期） |
| 安全   | HTTPS；敏感数据脱敏；合规存储     |
| 审核   | 符合教育部、微信小程序内容合规    |

## 5. 数据来源与更新（先做北京试点）

| 数据集          | 来源            | 更新频率  |
| --------------- | --------------- | --------- |
| 历年分数线      | 各省考院官方    | 每年6–7月 |
| 院校/专业元数据 | 教育部阳光高考  | 半年      |
| QS/软科排名     | 官方 API/爬虫   | 年度      |
| 就业/升学报告   | MyCOS、学校官网 | 年度      |
| 城市 CPI/GDP    | 统计局          | 季度      |
| 生活成本        | 第三方指数      | 半年      |

## 6. 接口契约（核心）

`POST /api/v1/recommend`

```json
{
  "province": "广东",
  "category": "物理",
  "score": 635,
  "rank": null,
  "subjects": ["物理", "化学", "生物"],
  "positive": ["计算机类", "人工智能"],
  "negative": ["地质类"],
  "weights": {
    "geo": 0.2,
    "ranking": 0.25,
    "employment": 0.25,
    "graduate": 0.15,
    "cost": 0.15
  }
}
```

返回 200: `{...}`

## 7. 技术选型（摘要）

- 前端：UniApp (Vue3) + Pinia + ECharts  
- 后端：FastAPI + PostgreSQL + Redis  
- 算法：Python（pandas, scikit-learn, CatBoost）  
- 部署：Docker + 阿里云容器服务（ACK）  
- 监控：Prometheus + Grafana；Sentry

## 8. 迭代与里程碑（8 周）

| 周次 | 重点         | 数据/算法 (A,B)     | 前端 (C,D)            | 交付物               |
| ---- | ------------ | ------------------- | --------------------- | -------------------- |
| 1    | 需求锁定     | 确认数据源列表      | UX 流程图，低保真原型 | 需求评审             |
| 2    | 数据抓取脚本 | 分数线 & 元数据 ETL | 页框架、登录          | Dev DB + Demo UI     |
| 3    | 录取概率 V0  | 统计法完成          | 输入页、偏好页        | /recommend Mock 接入 |
| 4    | 综合评分 V1  | 权重 & S 输出       | 推荐列表卡片 UI       | 真实接口联调         |
| 5    | 对比页       | 指标解释 API        | 雷达图、柱图          | Compare 完成         |
| 6    | Beta 内测    | 数据异常兜底        | 性能优化、骨架屏      | 内测包               |
| 7    | 灰度 & 优化  | 模型 A/B            | 崩溃 & 埋点           | 压测 & 监控          |
| 8    | 上线         | 数据备份            | 上线审核、分享海报    | 正式版发布           |

## 9. 里程碑验收指标

| 指标            | 达标范围 |
| --------------- | -------- |
| 推荐接口成功率  | ≥ 99%    |
| P95 响应时间    | ≤ 4s     |
| 首屏加载时间    | ≤ 2.5s   |
| Beta 用户满意度 | ≥ 4/5    |

## 10. 风险与对策

| 风险         | 等级 | 对策                         |
| ------------ | ---- | ---------------------------- |
| 数据更新延迟 | 中   | 增量爬虫 + 手动校验预案      |
| 省份规则差异 | 中   | 配置化选课 / 批次映射        |
| 高峰期并发   | 中   | 限流 + Redis 缓存 + 读写分离 |
| 审核驳回     | 低   | 预审资料、敏感词过滤         |
| 算法结果争议 | 低   | 提供指标解释、免责声明       |

## 附录

- A. 模型公式与变量说明  
- B. UI 组件规范（Figma 链接）  
- C. 接口 Swagger 文档地址
